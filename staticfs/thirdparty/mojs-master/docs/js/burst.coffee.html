<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title> - burst.coffee</title>

  <link rel="stylesheet" href="../assets/style.css">
  
    
      <style>
        
      </style>
    
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"/>
  <meta name="groc-relative-root" content="../"/>
  <meta name="groc-document-path" content="js/burst.coffee"/>
  
</head>
<body>
  <div id="file-area">
    <div id="meta">
      <code class="file-path">
      
        <a href="https://github.com/legomushroom/mojs.git/blob/master/js/burst.coffee">js/burst.coffee</a>
      
      </code>
    </div>
    <div id="document">
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>ignore coffescript sudo code
istanbul ignore next</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">bitsMap   = <span class="hljs-built_in">require</span> <span class="hljs-string">'./shapes/bitsMap'</span></div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>Tween     = require &#39;./tween/timeline&#39;</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">Transit   = <span class="hljs-built_in">require</span> <span class="hljs-string">'./transit'</span>
Swirl     = <span class="hljs-built_in">require</span> <span class="hljs-string">'./swirl'</span>
h         = <span class="hljs-built_in">require</span> <span class="hljs-string">'./h'</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Burst</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Transit</span></span>
  <span class="hljs-attribute">skipProps</span>: <span class="hljs-attribute">childOptions</span>: <span class="hljs-number">1</span>
  <span class="hljs-attribute">defaults</span>:</div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>presentation props</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">    <span class="hljs-attribute">count</span>:              <span class="hljs-number">5</span>
    <span class="hljs-attribute">degree</span>:             <span class="hljs-number">360</span>
    <span class="hljs-attribute">opacity</span>:            <span class="hljs-number">1</span>
    <span class="hljs-attribute">randomAngle</span>:        <span class="hljs-number">0</span>
    <span class="hljs-attribute">randomRadius</span>:       <span class="hljs-number">0</span></div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>position props/el props</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">    <span class="hljs-attribute">x</span>:                  <span class="hljs-number">100</span>
    <span class="hljs-attribute">y</span>:                  <span class="hljs-number">100</span>
    <span class="hljs-attribute">shiftX</span>:             <span class="hljs-number">0</span>
    <span class="hljs-attribute">shiftY</span>:             <span class="hljs-number">0</span>
    <span class="hljs-attribute">easing</span>:             <span class="hljs-string">'Linear.None'</span></div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>size props</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">    <span class="hljs-attribute">radius</span>:             { <span class="hljs-number">25</span>: <span class="hljs-number">75</span> }
    <span class="hljs-attribute">radiusX</span>:            <span class="hljs-literal">undefined</span>
    <span class="hljs-attribute">radiusY</span>:            <span class="hljs-literal">undefined</span>
    <span class="hljs-attribute">angle</span>:              <span class="hljs-number">0</span>
    <span class="hljs-attribute">size</span>:               <span class="hljs-literal">null</span>
    <span class="hljs-attribute">sizeGap</span>:            <span class="hljs-number">0</span></div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>callbacks</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">    <span class="hljs-attribute">duration</span>:           <span class="hljs-number">600</span>
    <span class="hljs-attribute">delay</span>:              <span class="hljs-number">0</span>
    <span class="hljs-attribute">onStart</span>:            <span class="hljs-literal">null</span>
    <span class="hljs-attribute">onComplete</span>:         <span class="hljs-literal">null</span>
    <span class="hljs-attribute">onCompleteChain</span>:    <span class="hljs-literal">null</span>
    <span class="hljs-attribute">onUpdate</span>:           <span class="hljs-literal">null</span>
    <span class="hljs-attribute">isResetAngles</span>:      <span class="hljs-literal">false</span>
  <span class="hljs-attribute">childDefaults</span>:
    <span class="hljs-comment">#-- intersection starts</span>
    <span class="hljs-attribute">radius</span>:             { <span class="hljs-number">7</span> : <span class="hljs-number">0</span> }
    <span class="hljs-attribute">radiusX</span>:            <span class="hljs-literal">undefined</span>
    <span class="hljs-attribute">radiusY</span>:            <span class="hljs-literal">undefined</span>
    <span class="hljs-attribute">angle</span>:              <span class="hljs-number">0</span>
    <span class="hljs-attribute">opacity</span>:            <span class="hljs-number">1</span></div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>callbacks</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">    <span class="hljs-attribute">onStart</span>:            <span class="hljs-literal">null</span>
    <span class="hljs-attribute">onComplete</span>:         <span class="hljs-literal">null</span>
    <span class="hljs-attribute">onUpdate</span>:           <span class="hljs-literal">null</span>
    <span class="hljs-comment">#-- intersection ends</span>
    <span class="hljs-attribute">points</span>:             <span class="hljs-number">3</span>
    <span class="hljs-attribute">duration</span>:           <span class="hljs-number">500</span>
    <span class="hljs-attribute">delay</span>:              <span class="hljs-number">0</span>
    <span class="hljs-attribute">repeat</span>:             <span class="hljs-number">0</span>
    <span class="hljs-attribute">yoyo</span>:               <span class="hljs-literal">false</span>
    <span class="hljs-attribute">easing</span>:             <span class="hljs-string">'Linear.None'</span>
    <span class="hljs-attribute">type</span>:               <span class="hljs-string">'circle'</span>
    <span class="hljs-attribute">fill</span>:               <span class="hljs-string">'deeppink'</span>
    <span class="hljs-attribute">fillOpacity</span>:        <span class="hljs-number">1</span>
    <span class="hljs-attribute">isSwirl</span>:            <span class="hljs-literal">false</span>
    <span class="hljs-attribute">swirlSize</span>:          <span class="hljs-number">10</span>
    <span class="hljs-attribute">swirlFrequency</span>:     <span class="hljs-number">3</span>
    <span class="hljs-attribute">stroke</span>:             <span class="hljs-string">'transparent'</span>
    <span class="hljs-attribute">strokeWidth</span>:        <span class="hljs-number">0</span>
    <span class="hljs-attribute">strokeOpacity</span>:      <span class="hljs-number">1</span>
    <span class="hljs-attribute">strokeDasharray</span>:    <span class="hljs-string">''</span>
    <span class="hljs-attribute">strokeDashoffset</span>:   <span class="hljs-string">''</span>
    <span class="hljs-attribute">strokeLinecap</span>:      <span class="hljs-literal">null</span>
  <span class="hljs-attribute">optionsIntersection</span>:
    <span class="hljs-attribute">radius</span>:     <span class="hljs-number">1</span>
    <span class="hljs-attribute">radiusX</span>:    <span class="hljs-number">1</span>
    <span class="hljs-attribute">radiusY</span>:    <span class="hljs-number">1</span>
    <span class="hljs-attribute">angle</span>:      <span class="hljs-number">1</span>
    <span class="hljs-attribute">opacity</span>:    <span class="hljs-number">1</span>
    <span class="hljs-attribute">onStart</span>:    <span class="hljs-number">1</span>
    <span class="hljs-attribute">onComplete</span>: <span class="hljs-number">1</span>
    <span class="hljs-attribute">onUpdate</span>:   <span class="hljs-number">1</span>
  <span class="hljs-attribute">run</span>:<span class="hljs-function"><span class="hljs-params">(o)</span>-&gt;</span>
    <span class="hljs-keyword">if</span> o? <span class="hljs-keyword">and</span> Object.keys(o).length
      <span class="hljs-keyword">if</span> o.count <span class="hljs-keyword">or</span> o.childOptions?.count
        <span class="hljs-property">@h</span>.warn <span class="hljs-string">'Sorry, count can not be changed on run'</span>
      <span class="hljs-property">@extendDefaults</span>(o)</div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>copy child options to options</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">      keys = Object.keys(o.childOptions <span class="hljs-keyword">or</span> {}); <span class="hljs-property">@o</span>.childOptions ?= {}
      <span class="hljs-property">@o</span>.childOptions[key] = o.childOptions[key] <span class="hljs-keyword">for</span> key, i <span class="hljs-keyword">in</span> keys</div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>tune transits</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">      len = <span class="hljs-property">@transits</span>.length
      <span class="hljs-keyword">while</span>(len--)</div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>we should keep transit&#39;s angle otherwise
it will fallback to default 0 value</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">        option = <span class="hljs-property">@getOption</span>(len)
        <span class="hljs-keyword">if</span> !o.childOptions?.angle? <span class="hljs-keyword">and</span> !o.angleShift?
          option.angle = <span class="hljs-property">@transits</span>[len].o.angle</div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>calculate bit angle if new angle related option passed
and not isResetAngles</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> !o.isResetAngles
          option.angle = <span class="hljs-property">@getBitAngle</span> option.angle, len

        <span class="hljs-property">@transits</span>[len].tuneNewOption option, <span class="hljs-literal">true</span>
      <span class="hljs-property">@timeline</span>.recalcDuration()
    <span class="hljs-keyword">if</span> <span class="hljs-property">@props</span>.randomAngle <span class="hljs-keyword">or</span> <span class="hljs-property">@props</span>.randomRadius
      len = <span class="hljs-property">@transits</span>.length
      <span class="hljs-keyword">while</span>(len--)
        tr = <span class="hljs-property">@transits</span>[len]
        <span class="hljs-property">@props</span>.randomAngle  <span class="hljs-keyword">and</span> tr.setProp <span class="hljs-attribute">angleShift</span>:  <span class="hljs-property">@generateRandomAngle</span>()
        <span class="hljs-property">@props</span>.randomRadius <span class="hljs-keyword">and</span> tr.setProp <span class="hljs-attribute">radiusScale</span>: <span class="hljs-property">@generateRandomRadius</span>()
    <span class="hljs-property">@startTween</span>()
    
  <span class="hljs-attribute">createBit</span>:<span class="hljs-function">-&gt;</span>
    <span class="hljs-property">@transits</span> = []
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> [<span class="hljs-number">0.</span>..<span class="hljs-property">@props</span>.count]
      option = <span class="hljs-property">@getOption</span>(i); option.ctx = <span class="hljs-property">@ctx</span>; option.index = i
      option.isDrawLess = option.isRunLess = option.isTweenLess = <span class="hljs-literal">true</span>
      <span class="hljs-property">@props</span>.randomAngle  <span class="hljs-keyword">and</span> (option.angleShift  = <span class="hljs-property">@generateRandomAngle</span>())
      <span class="hljs-property">@props</span>.randomRadius <span class="hljs-keyword">and</span> (option.radiusScale = <span class="hljs-property">@generateRandomRadius</span>())
      <span class="hljs-property">@transits</span>.push <span class="hljs-keyword">new</span> Swirl option

  <span class="hljs-attribute">addBitOptions</span>:<span class="hljs-function">-&gt;</span>
    points = <span class="hljs-property">@props</span>.count
    <span class="hljs-property">@degreeCnt</span> = <span class="hljs-keyword">if</span> <span class="hljs-property">@props</span>.degree % <span class="hljs-number">360</span> <span class="hljs-keyword">is</span> <span class="hljs-number">0</span> <span class="hljs-keyword">then</span> points <span class="hljs-keyword">else</span> points-<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-number">1</span>
    
    step = <span class="hljs-property">@props</span>.degree/<span class="hljs-property">@degreeCnt</span>
    <span class="hljs-keyword">for</span> transit, i <span class="hljs-keyword">in</span> <span class="hljs-property">@transits</span>
      aShift = transit.props.angleShift <span class="hljs-keyword">or</span> <span class="hljs-number">0</span>
      pointStart = <span class="hljs-property">@getSidePoint</span> <span class="hljs-string">'start'</span>, i*step + aShift
      pointEnd   = <span class="hljs-property">@getSidePoint</span> <span class="hljs-string">'end'</span>,   i*step + aShift

      transit.o.x = <span class="hljs-property">@getDeltaFromPoints</span> <span class="hljs-string">'x'</span>, pointStart, pointEnd
      transit.o.y = <span class="hljs-property">@getDeltaFromPoints</span> <span class="hljs-string">'y'</span>, pointStart, pointEnd

      transit.o.angle = <span class="hljs-property">@getBitAngle</span> transit.o.angle, i <span class="hljs-keyword">if</span> !<span class="hljs-property">@props</span>.isResetAngles
      transit.extendDefaults()</div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><hr>
</div>
        </div>
      
      
      </div>
    
      <div class="segment">
      
        <div class="comments doc-section">
          <div class="wrapper"><p><span class='doc-section-header'>
Method <strong>getBitAngle</strong>
</span></p>
<p>Method to get transits angle in burst so
it will follow circular shape</p>
<p>Parameters:</p>
<ul>
<li><strong><code>base</code> must be a Number, Object.</strong><br/>(angle)</li>
<li><strong><code>transit</code> must be an Integer.</strong><br/>(&#39;s index in burst)</li>
</ul>
<p><strong>Returns a Numebr</strong><br/>(angle in burst)</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">  <span class="hljs-attribute">getBitAngle</span>:<span class="hljs-function"><span class="hljs-params">(angle, i)</span>-&gt;</span>
    points = <span class="hljs-property">@props</span>.count
    degCnt = <span class="hljs-keyword">if</span> <span class="hljs-property">@props</span>.degree % <span class="hljs-number">360</span> <span class="hljs-keyword">is</span> <span class="hljs-number">0</span> <span class="hljs-keyword">then</span> points <span class="hljs-keyword">else</span> points-<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-number">1</span>
    step = <span class="hljs-property">@props</span>.degree/degCnt; angleAddition = i*step + <span class="hljs-number">90</span>
    angleShift = <span class="hljs-property">@transits</span>[i].props.angleShift <span class="hljs-keyword">or</span> <span class="hljs-number">0</span></div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>if not delta option</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">    angle = <span class="hljs-keyword">if</span> <span class="hljs-keyword">typeof</span> angle <span class="hljs-keyword">isnt</span> <span class="hljs-string">'object'</span>
      angle + angleAddition + angleShift</div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>if delta option calculate delta based on
angle in burst for each transit and angleShift</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">    <span class="hljs-keyword">else</span>
      keys = Object.keys(angle); start = keys[<span class="hljs-number">0</span>]
      end = angle[start]; curAngleShift = angleAddition+angleShift
      newStart = parseFloat(start) + curAngleShift
      newEnd   = parseFloat(end)   + curAngleShift
      delta = {}; delta[newStart] = newEnd
      delta
    angle

  <span class="hljs-attribute">getSidePoint</span>:<span class="hljs-function"><span class="hljs-params">(side, angle)</span>-&gt;</span>
    sideRadius = <span class="hljs-property">@getSideRadius</span> side
    pointStart = <span class="hljs-property">@h</span>.getRadialPoint
      <span class="hljs-attribute">radius</span>:  sideRadius.radius
      <span class="hljs-attribute">radiusX</span>: sideRadius.radiusX
      <span class="hljs-attribute">radiusY</span>: sideRadius.radiusY
      <span class="hljs-attribute">angle</span>:   angle
      <span class="hljs-attribute">center</span>:  <span class="hljs-attribute">x</span>: <span class="hljs-property">@props</span>.center, <span class="hljs-attribute">y</span>: <span class="hljs-property">@props</span>.center
  <span class="hljs-attribute">getSideRadius</span>:<span class="hljs-function"><span class="hljs-params">(side)</span>-&gt;</span>
    <span class="hljs-attribute">radius</span>:  <span class="hljs-property">@getRadiusByKey</span> <span class="hljs-string">'radius'</span>,  side
    <span class="hljs-attribute">radiusX</span>: <span class="hljs-property">@getRadiusByKey</span> <span class="hljs-string">'radiusX'</span>, side
    <span class="hljs-attribute">radiusY</span>: <span class="hljs-property">@getRadiusByKey</span> <span class="hljs-string">'radiusY'</span>, side
  <span class="hljs-attribute">getRadiusByKey</span>:<span class="hljs-function"><span class="hljs-params">(key, side)</span>-&gt;</span>
    <span class="hljs-keyword">if</span> <span class="hljs-property">@deltas</span>[key]? <span class="hljs-keyword">then</span> <span class="hljs-property">@deltas</span>[key][side]
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-property">@props</span>[key]? <span class="hljs-keyword">then</span> <span class="hljs-property">@props</span>[key]
  <span class="hljs-attribute">getDeltaFromPoints</span>:<span class="hljs-function"><span class="hljs-params">(key, pointStart, pointEnd)</span>-&gt;</span>
    delta = {}
    <span class="hljs-keyword">if</span> pointStart[key] <span class="hljs-keyword">is</span> pointEnd[key] <span class="hljs-keyword">then</span> delta = pointStart[key]
    <span class="hljs-keyword">else</span> delta[pointStart[key]] = pointEnd[key]; delta
  <span class="hljs-attribute">draw</span>:<span class="hljs-function"><span class="hljs-params">(progress)</span>-&gt;</span> <span class="hljs-property">@drawEl</span>()

  <span class="hljs-attribute">isNeedsTransform</span>:<span class="hljs-function">-&gt;</span>
    <span class="hljs-property">@isPropChanged</span>(<span class="hljs-string">'shiftX'</span>)<span class="hljs-keyword">or</span><span class="hljs-property">@isPropChanged</span>(<span class="hljs-string">'shiftY'</span>)<span class="hljs-keyword">or</span><span class="hljs-property">@isPropChanged</span>(<span class="hljs-string">'angle'</span>)
  <span class="hljs-attribute">fillTransform</span>:<span class="hljs-function">-&gt;</span>
    <span class="hljs-string">"rotate(<span class="hljs-subst">#{<span class="hljs-property">@props</span>.angle}</span>deg) translate(<span class="hljs-subst">#{<span class="hljs-property">@props</span>.shiftX}</span>, <span class="hljs-subst">#{<span class="hljs-property">@props</span>.shiftY}</span>)"</span>
  <span class="hljs-attribute">createTween</span>:<span class="hljs-function">-&gt;</span>
    <span class="hljs-keyword">super</span>; i = <span class="hljs-property">@transits</span>.length; <span class="hljs-property">@timeline</span>.add(<span class="hljs-property">@transits</span>[i].tween) <span class="hljs-keyword">while</span>(i--)
    
  <span class="hljs-attribute">calcSize</span>:<span class="hljs-function">-&gt;</span>
    largestSize = -<span class="hljs-number">1</span>
    <span class="hljs-keyword">for</span> transit, i <span class="hljs-keyword">in</span> <span class="hljs-property">@transits</span>
      transit.calcSize()
      <span class="hljs-keyword">if</span> largestSize &lt; transit.props.size
        largestSize = transit.props.size
    radius = <span class="hljs-property">@calcMaxRadius</span>()
    <span class="hljs-property">@props</span>.size   = largestSize + <span class="hljs-number">2</span>*radius
    <span class="hljs-property">@props</span>.size   += <span class="hljs-number">2</span>*<span class="hljs-property">@props</span>.sizeGap
    <span class="hljs-property">@props</span>.center = <span class="hljs-property">@props</span>.size/<span class="hljs-number">2</span>
    <span class="hljs-property">@addBitOptions</span>()

  <span class="hljs-attribute">getOption</span>:<span class="hljs-function"><span class="hljs-params">(i)</span>-&gt;</span>
    option = {}; keys = Object.keys(<span class="hljs-property">@childDefaults</span>); len = keys.length
    <span class="hljs-keyword">while</span>(len--)
      key = keys[len]</div></div>
      
      </div>
    
      <div class="segment">
      
      
        <div class="code"><div class="wrapper">      option[key]  = <span class="hljs-property">@getPropByMod</span> <span class="hljs-attribute">key</span>: key, <span class="hljs-attribute">i</span>: i, <span class="hljs-attribute">from</span>: <span class="hljs-property">@o</span>.childOptions</div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>if fail
if the same option could be defined for parent and child
get the option from childDefaults and continue</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">      <span class="hljs-keyword">if</span> <span class="hljs-property">@optionsIntersection</span>[key]
        option[key] ?= <span class="hljs-property">@getPropByMod</span> <span class="hljs-attribute">key</span>: key, <span class="hljs-attribute">i</span>: i, <span class="hljs-attribute">from</span>: <span class="hljs-property">@childDefaults</span>
        <span class="hljs-keyword">continue</span></div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>else check the option on parent</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">      option[key] ?= <span class="hljs-property">@getPropByMod</span> <span class="hljs-attribute">key</span>: key, <span class="hljs-attribute">i</span>: i, <span class="hljs-attribute">from</span>: <span class="hljs-property">@o</span>
      option[key] ?= <span class="hljs-property">@getPropByMod</span> <span class="hljs-attribute">key</span>: key, <span class="hljs-attribute">i</span>: i, <span class="hljs-attribute">from</span>: <span class="hljs-property">@childDefaults</span>
    option

  <span class="hljs-attribute">getPropByMod</span>:<span class="hljs-function"><span class="hljs-params">(o)</span>-&gt;</span>
    prop = (o.from <span class="hljs-keyword">or</span> <span class="hljs-property">@o</span>.childOptions)?[o.key]
    <span class="hljs-keyword">if</span> <span class="hljs-property">@h</span>.isArray(prop) <span class="hljs-keyword">then</span> prop[o.i % prop.length] <span class="hljs-keyword">else</span> prop
  <span class="hljs-attribute">generateRandomAngle</span>:<span class="hljs-function"><span class="hljs-params">(i)</span>-&gt;</span>
    randomness = parseFloat(<span class="hljs-property">@props</span>.randomAngle)
    randdomness = <span class="hljs-keyword">if</span> randomness &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">then</span> <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> randomness &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">then</span> <span class="hljs-number">0</span>
    <span class="hljs-property">@h</span>.rand(<span class="hljs-number">0</span>, <span class="hljs-keyword">if</span> randomness <span class="hljs-keyword">then</span> randomness*<span class="hljs-number">360</span> <span class="hljs-keyword">else</span> <span class="hljs-number">180</span>)
  <span class="hljs-attribute">generateRandomRadius</span>:<span class="hljs-function"><span class="hljs-params">(i)</span>-&gt;</span>
    randomness = parseFloat(<span class="hljs-property">@props</span>.randomRadius)
    randdomness = <span class="hljs-keyword">if</span> randomness &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">then</span> <span class="hljs-number">1</span> <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> randomness &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">then</span> <span class="hljs-number">0</span>
    start = <span class="hljs-keyword">if</span> randomness <span class="hljs-keyword">then</span> (<span class="hljs-number">1</span>-randomness)*<span class="hljs-number">100</span> <span class="hljs-keyword">else</span> (<span class="hljs-number">1</span>-.<span class="hljs-number">5</span>)*<span class="hljs-number">100</span>
    <span class="hljs-property">@h</span>.rand(start, <span class="hljs-number">100</span>)/<span class="hljs-number">100</span>

  <span class="hljs-attribute">then</span>:<span class="hljs-function"><span class="hljs-params">(o)</span>-&gt;</span>
    <span class="hljs-property">@h</span>.error <span class="hljs-string">"Burst's \"then\" method is under consideration,
      you can vote for it in github repo issues"</span></div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments doc-section">
          <div class="wrapper"><p><span class='doc-section-header'>
 o and o</p>
<ol>
<li>get i option from merged object</li>
<li>pass the object to transit then</li>
<li>transform self chain on run and transits while(i--)
</span></li>
</ol>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">    @

<span class="hljs-built_in">module</span>.exports = Burst
</div></div>
      
      </div>
    
    </div>
  </div>

  <script src="../toc.js"></script>
  <script src="../assets/libs.js"></script>
  <script src="../assets/behavior.js"></script>

  
    
      <script>
        function __cp_domReady(e){/in/.test(document.readyState)?setTimeout("__cp_domReady("+e+")",9):e()}document.getElementsByClassName||(document.getElementsByClassName=function(e){var t,n,a,r=document,s=[];if(r.querySelectorAll)return r.querySelectorAll("."+e);if(r.evaluate)for(n=".//*[contains(concat(' ', @class, ' '), ' "+e+" ')]",t=r.evaluate(n,r,null,0,null);a=t.iterateNext();)s.push(a);else for(t=r.getElementsByTagName("*"),n=new RegExp("(^|\\s)"+e+"(\\s|$)"),a=0;a<t.length;a++)n.test(t[a].className)&&s.push(t[a]);return s});var CodePenEmbed={width:"100%",init:function(){return window.__cp_embed_script_ran?0:(window.__cp_embed_script_ran=!0,this.showCodePenEmbeds(),void this.listenToParentPostMessages())},showCodePenEmbeds:function(){for(var e=document.getElementsByClassName("codepen"),t=e.length-1;t>-1;t--){var n=this._getParamsFromAttributes(e[t]);if(n=this._convertOldDataAttributesToNewDataAttributes(n),n.user=this._findUsernameForURL(n,e[t]),this._paramsHasRequiredAttributes(n)){var a=this._buildURL(n),r=this._buildIFrame(n,a);this._addIFrameToPage(e[t],r)}}},_findUsernameForURL:function(e,t){if("string"==typeof e.user)return e.user;for(var n=0,a=t.children.length;a>n;n++){var r=t.children[n],s=r.href||"",i=s.match(/codepen\.(io|dev)\/(\w+)\/pen\//i);if(i)return i[2]}return"anon"},_paramsHasRequiredAttributes:function(e){return e["slug-hash"]},_getParamsFromAttributes:function(e){for(var t={},n=e.attributes,a=0,r=n.length;r>a;a++){var s=n[a].name;0===s.indexOf("data-")&&(t[s.replace("data-","")]=n[a].value)}return t},_convertOldDataAttributesToNewDataAttributes:function(e){return e.href&&(e["slug-hash"]=e.href),e.type&&(e["default-tab"]=e.type),e.safe&&(e.animations="true"===e.safe?"run":"stop-after-5"),e},_buildURL:function(e){var t=this._getHost(e),n=e.user?e.user:"anon",a="?"+this._getGetParams(e),r=[t,n,"embed",e["slug-hash"]+a].join("/");return r.replace(/\/\//g,"//")},_getHost:function(e){return e.host?this._getSafeHost(e.host):"file:"===document.location.protocol?"http://codepen.io":"//codepen.io"},_getSafeHost:function(e){return e.match(/^\/\//)||!e.match(/http:/)?document.location.protocol+"//"+e:e},_getGetParams:function(e){var t="";for(var n in e)""!==t&&(t+="&"),t+=n+"="+encodeURIComponent(e[n]);return t},_buildIFrame:function(e,t){var n="";""!==e["class"]&&(n=e["class"]);var a={id:"cp_embed_"+e["slug-hash"].replace("/","_"),src:t,scrolling:"no",frameborder:"0",height:this._getHeight(e),allowTransparency:"true",allowfullscreen:"true","class":"cp_embed_iframe "+n,style:"width: "+this.width+"; overflow: hidden;"},r="<iframe ";for(var s in a)r+=s+'="'+a[s]+'" ';return r+="></iframe>"},_getHeight:function(e){return e.height?"auto"===e.height?300:e.height:300},_addIFrameToPage:function(e,t){if(e.parentNode){var n=document.createElement("div");n.innerHTML=t,e.parentNode.replaceChild(n,e)}else e.innerHTML=t},listenToParentPostMessages:function(){var eventMethod=window.addEventListener?"addEventListener":"attachEvent",eventListener=window[eventMethod],messageEvent="attachEvent"===eventMethod?"onmessage":"message";eventListener(messageEvent,function(e){try{var dataObj=eval("("+e.data+")"),iframe=document.getElementById("cp_embed_"+dataObj.hash);iframe&&(iframe.height=dataObj.height)}catch(err){}},!1)}};__cp_domReady(function(){CodePenEmbed.init()});
      </script>
    
  
</body>
</html>